<md-card class="card__title">
  <h3 class="title">{{'key-settings.title' | translate}}</h3>
  <button 
    class="back-button"
    type="button"
    md-icon-button
    attr.aria-label="{{'key-settings.accessibilityInfo.close' | translate}}" 
    (click)=closeAndGoToMain() 
    mdTooltip="{{'key-settings.tooltip.close' | translate}}">
    <md-icon>arrow_back</md-icon>
    <span 
      class="cdk-visually-hidden">
      {{'key-settings.accessibilityInfo.close' | translate}}</span>
  </button>
</md-card>
<md-card class="card__key-settings">
  <md-card-content>
    <form 
      *ngIf="key$ | async as key" 
      #f="ngForm">
        <md-form-field class="key--fotn-size">
          <input 
            required
            mdInput 
            placeholder="{{'key-settings.keyInputPlaceholder' | translate}}"
            [(ngModel)]="key.key"
            ngModel
            #keyInput="ngModel"
            name="key">
          <md-error *ngIf="!keyInput.valid && keyInput.touched">
            {{'key-settings.error.key' | translate}} 
            <strong>{{'key-settings.error.required' | translate}}</strong>
          </md-error>
        </md-form-field>
        <md-form-field>
          <input 
            required 
            mdInput 
            placeholder="{{'key-settings.streetInputPlaceholder' | translate}}"
            [(ngModel)]="key.streetName" 
            ngModel
            #streetName="ngModel"
            name="streetName">
          <md-error *ngIf="!streetName.valid && streetName.touched">
            {{'key-settings.error.street' | translate}} 
            <strong>{{'key-settings.error.required' | translate}}</strong>
          </md-error>
        </md-form-field>
        <md-form-field class="example-full-width">
          <input 
            mdInput
            #message 
            maxlength="256" 
            placeholder="{{'key-settings.note' | translate}}" 
            [(ngModel)]="key.note"  
            name="note">
          <md-hint align="end">{{message.value.length}} / 256</md-hint>
        </md-form-field>
      <table cellspacing="0">
        <tr>
          <td>
            <md-form-field>
              <input
                mdInput 
                disabled
                placeholder="{{'key-settings.latitudePlaceholder' | translate}}" 
                ngModel
                #keyLat="ngModel"
                name="lat" 
                [ngModel]="key.lat">
            </md-form-field>
          </td>
          <td>
            <md-form-field>
              <input
                mdInput
                disabled 
                placeholder="{{'key-settings.longitudePlaceholder' | translate}}" 
                ngModel
                #keyLng="ngModel"
                name="lng" 
                [ngModel]="key.lng">
            </md-form-field>
          </td>
        </tr>
      </table>
      <div class="action-container">
        <button 
          color="primary" 
          type="submit"
          md-raised-button 
          attr.aria-label="{{'key-settings.accessibilityInfo.save' | translate}}" 
          (click)="saveKey()"
          mdTooltip="{{'key-settings.tooltip.save' | translate}}"
          [disabled]="!f.valid">
          <md-icon>save</md-icon>
          <span 
            class="cdk-visually-hidden">
            {{'key-settings.accessibilityInfo.save' | translate}}</span>
        </button>
      </div>      
    </form>
  </md-card-content>
</md-card>